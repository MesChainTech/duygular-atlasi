<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ Duygular AtlasÄ±</title>
    <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary:#FF6B6B;--secondary:#4ECDC4;--accent:#FFE66D;--success:#2ECC71;--warning:#F39C12;--danger:#E74C3C;--purple:#9B59B6; }
        body.dark { --bg:#0f0f1a;--card:#1a1a2e;--text:#fff;--cell:#2d3748;--border:#4a5568; }
        body.light { --bg:#f0f4f8;--card:#fff;--text:#2d3748;--cell:#e2e8f0;--border:#cbd5e0; }
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Poppins',sans-serif;background:var(--bg);min-height:100vh;color:var(--text);transition:all .3s}
        .confetti-box{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999;overflow:hidden}
        .confetti{position:absolute;width:10px;height:10px;top:-10px;animation:fall linear forwards}
        @keyframes fall{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}
        .header{background:linear-gradient(135deg,var(--primary),var(--purple));padding:12px 20px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 20px rgba(0,0,0,.3)}
        .logo{font-family:'Righteous',cursive;font-size:1.5rem;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
        .header-btns{display:flex;gap:8px}
        .hbtn{padding:8px 16px;border:none;border-radius:25px;font-size:.85rem;cursor:pointer;font-weight:600;transition:all .3s}
        .hbtn:hover{transform:scale(1.05)}
        .btn-admin{background:#fff;color:var(--purple)}
        .btn-theme{background:var(--accent);color:#333}
        .btn-sound{background:rgba(255,255,255,.2);color:#fff}
        .main{display:flex;gap:15px;padding:15px;max-width:1400px;margin:0 auto}
        .left{width:220px;display:flex;flex-direction:column;gap:12px}
        .box{background:var(--card);border-radius:16px;padding:15px;box-shadow:0 4px 15px rgba(0,0,0,.1);border:2px solid transparent;transition:all .3s}
        .box:hover{border-color:var(--secondary)}
        .box-title{font-family:'Righteous',cursive;color:var(--accent);font-size:1rem;margin-bottom:12px}
        .pcard{background:linear-gradient(135deg,rgba(255,255,255,.1),rgba(255,255,255,.05));border-radius:12px;padding:10px 12px;margin-bottom:8px;border:3px solid transparent;display:flex;align-items:center;gap:10px;transition:all .3s}
        .pcard.active{border-color:var(--accent);box-shadow:0 0 20px rgba(255,230,109,.4);transform:scale(1.02);background:linear-gradient(135deg,rgba(255,230,109,.2),rgba(255,230,109,.1))}
        .pcard.jail{border-color:var(--danger);background:linear-gradient(135deg,rgba(231,76,60,.2),rgba(231,76,60,.1))}
        .pion{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:700;color:#fff;box-shadow:0 3px 10px rgba(0,0,0,.3);border:2px solid #fff}
        .pinfo{flex:1}
        .pname{font-weight:600;font-size:.9rem}
        .pcoins{color:var(--accent);font-size:.85rem;font-weight:700}
        .center{flex:1}
        .board-wrap{background:var(--card);border-radius:20px;padding:15px;box-shadow:0 8px 30px rgba(0,0,0,.2);border:3px solid var(--secondary)}
        .board-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:10px;border-bottom:2px solid var(--border)}
        .board-title{font-family:'Righteous',cursive;font-size:1.2rem;background:linear-gradient(135deg,var(--secondary),var(--primary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .turn-info{background:linear-gradient(135deg,var(--accent),var(--warning));padding:6px 18px;border-radius:25px;font-size:.85rem;color:#333;font-weight:700;box-shadow:0 3px 10px rgba(255,230,109,.4)}
        .board-content{display:flex;gap:15px}
        .game-board{display:grid;grid-template-columns:repeat(9,1fr);grid-template-rows:repeat(9,1fr);gap:3px;width:380px;min-width:380px;aspect-ratio:1;background:var(--border);padding:3px;border-radius:12px}
        .cell{background:var(--cell);border-radius:6px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:.6rem;position:relative;min-height:40px;transition:all .2s;cursor:pointer}
        .cell:hover:not(.empty){transform:scale(1.15);z-index:10;box-shadow:0 5px 20px rgba(0,0,0,.3)}
        .cell.empty{background:transparent;cursor:default}
        .cell.start{background:linear-gradient(135deg,#00b894,#00cec9)}
        .cell.finish{background:linear-gradient(135deg,var(--accent),#fd79a8)}
        .cell.jail{background:linear-gradient(135deg,#636e72,#2d3436)}
        .cell.bonus{background:linear-gradient(135deg,var(--purple),#e056fd)}
        .cell.flag{background:linear-gradient(135deg,var(--secondary),#74b9ff)}
        .cell.emotion{background:linear-gradient(135deg,var(--primary),#fd79a8)}
        .cell.penalty{background:linear-gradient(135deg,var(--danger),#e17055)}
        .cell-num{font-size:.5rem;opacity:.7;color:#fff}
        .cell-icon{font-size:1rem;filter:drop-shadow(1px 1px 2px rgba(0,0,0,.3))}
        .cell .pion{position:absolute;width:20px;height:20px;font-size:.55rem;box-shadow:0 3px 8px rgba(0,0,0,.4);z-index:50}
        .pion-box{position:absolute;top:2px;left:2px;right:2px;bottom:2px;display:flex;flex-wrap:wrap;gap:2px;align-items:center;justify-content:center}
        .card-area{flex:1;background:linear-gradient(135deg,rgba(0,0,0,.2),rgba(0,0,0,.1));border-radius:16px;padding:15px;display:flex;flex-direction:column;min-height:380px;border:2px solid var(--border)}
        .card-display{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center}
        .gcard{border-radius:16px;padding:20px;width:100%;max-width:300px;box-shadow:0 8px 25px rgba(0,0,0,.2);animation:cardPop .5s ease}
        @keyframes cardPop{0%{transform:scale(.8) rotateY(90deg);opacity:0}100%{transform:scale(1) rotateY(0);opacity:1}}
        .gcard.flag{background:linear-gradient(135deg,#74b9ff,#0984e3);color:#fff}
        .gcard.emotion{background:linear-gradient(135deg,#fd79a8,#e84393);color:#fff}
        .gcard.penalty{background:linear-gradient(135deg,#636e72,#2d3436);color:#fff}
        .gcard.bonus{background:linear-gradient(135deg,var(--accent),#fdcb6e);color:#333}
        .gcard.reward{background:linear-gradient(135deg,#00b894,#55efc4);color:#fff}
        .card-type{font-size:.75rem;text-transform:uppercase;letter-spacing:2px;opacity:.8;margin-bottom:8px}
        .card-icon{font-size:3.5rem;margin:12px 0;animation:bounce 1s ease infinite}
        @keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
        .card-title{font-family:'Righteous',cursive;font-size:1.1rem;margin-bottom:8px}
        .card-text{font-size:.9rem;line-height:1.5;opacity:.95}
        .opts{margin-top:15px;width:100%}
        .opt-btn{width:100%;padding:12px 15px;margin-bottom:8px;border:3px solid rgba(255,255,255,.3);border-radius:12px;background:rgba(255,255,255,.1);color:var(--text);font-size:.9rem;font-weight:600;cursor:pointer;transition:all .3s;text-align:left;display:flex;align-items:center;gap:12px}
        .opt-btn:hover:not(:disabled){background:rgba(255,255,255,.2);border-color:var(--secondary);transform:translateX(8px)}
        .opt-btn.correct{background:var(--success)!important;border-color:var(--success)!important;color:#fff!important;animation:pulse .5s}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .opt-btn.wrong{background:var(--danger)!important;border-color:var(--danger)!important;color:#fff!important;animation:shake .5s}
        @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}
        .opt-flag{font-size:1.4rem}
        .act-btns{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:15px}
        .act-btn{padding:12px 24px;border:none;border-radius:25px;font-family:'Poppins',sans-serif;font-weight:700;font-size:.9rem;cursor:pointer;transition:all .3s;box-shadow:0 4px 15px rgba(0,0,0,.2)}
        .act-btn:hover{transform:scale(1.08) translateY(-2px)}
        .btn-suc{background:linear-gradient(135deg,var(--success),#00b894);color:#fff}
        .btn-dan{background:linear-gradient(135deg,var(--danger),#ff6b6b);color:#fff}
        .btn-war{background:linear-gradient(135deg,var(--warning),#fdcb6e);color:#333}
        .btn-pur{background:linear-gradient(135deg,var(--purple),#a29bfe);color:#fff}
        .msg-box{padding:20px;border-radius:16px;text-align:center;background:rgba(255,255,255,.1);animation:msgPop .4s}
        @keyframes msgPop{0%{transform:scale(.9);opacity:0}100%{transform:scale(1);opacity:1}}
        .msg-box h3{font-family:'Righteous',cursive;color:var(--accent);font-size:1.2rem;margin-bottom:8px}
        .msg-box p{font-size:.95rem;opacity:.9}
        .msg-box.success{border:3px solid var(--success)}
        .msg-box.error{border:3px solid var(--danger)}
        .msg-box.warning{border:3px solid var(--warning)}
        .cult-note{background:linear-gradient(135deg,rgba(78,205,196,.2),rgba(78,205,196,.1));border-left:4px solid var(--secondary);border-radius:10px;padding:12px 15px;margin-top:12px;text-align:left;font-size:.85rem}
        .cult-note strong{color:var(--secondary)}
        .dice-area{display:flex;align-items:center;justify-content:center;gap:20px;margin-top:15px;padding:15px;background:linear-gradient(135deg,rgba(0,0,0,.2),rgba(0,0,0,.1));border-radius:16px}
        .dice-btn{background:linear-gradient(135deg,var(--accent),var(--warning));border:none;border-radius:20px;padding:15px 35px;font-family:'Righteous',cursive;font-size:1.1rem;cursor:pointer;color:#333;display:flex;align-items:center;gap:10px;box-shadow:0 5px 20px rgba(255,230,109,.4);transition:all .3s}
        .dice-btn:hover:not(:disabled){transform:scale(1.08) translateY(-3px)}
        .dice-btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
        .dice-result{font-size:3rem;min-width:70px;text-align:center;font-family:'Righteous',cursive;color:var(--accent);text-shadow:0 0 20px rgba(255,230,109,.5)}
        .dice-anim{animation:diceRoll .15s ease infinite}
        @keyframes diceRoll{0%,100%{transform:rotate(0) scale(1)}50%{transform:rotate(180deg) scale(1.2)}}
        .right{width:180px;display:flex;flex-direction:column;gap:12px}
        .mini-deck{background:var(--card);border-radius:16px;padding:15px;text-align:center;cursor:pointer;transition:all .3s;border:3px solid transparent;box-shadow:0 4px 15px rgba(0,0,0,.1)}
        .mini-deck:hover{border-color:var(--secondary);transform:translateY(-5px)}
        .mini-deck-icon{font-size:2rem;margin-bottom:5px}
        .mini-deck-title{font-size:.8rem;font-weight:600}
        .start-screen{text-align:center;padding:30px}
        .start-screen h2{font-family:'Righteous',cursive;font-size:2rem;margin-bottom:10px;background:linear-gradient(135deg,var(--primary),var(--secondary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .pinput{display:flex;gap:10px;margin-bottom:15px;max-width:350px;margin-left:auto;margin-right:auto}
        .pinput input{flex:1;padding:12px 18px;border:3px solid var(--border);border-radius:12px;background:var(--card);color:var(--text);font-size:1rem;transition:all .3s}
        .pinput input:focus{outline:none;border-color:var(--secondary)}
        .pinput input::placeholder{color:var(--text);opacity:.5}
        .color-sel{display:flex;gap:8px;justify-content:center;margin-bottom:20px}
        .color-opt{width:35px;height:35px;border-radius:50%;border:4px solid transparent;cursor:pointer;transition:all .3s;box-shadow:0 3px 10px rgba(0,0,0,.2)}
        .color-opt:hover,.color-opt.selected{border-color:#fff;transform:scale(1.2)}
        .color-opt.used{opacity:.3;pointer-events:none;transform:scale(.8)}
        .plist{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:20px 0}
        .ptag{background:linear-gradient(135deg,rgba(255,255,255,.15),rgba(255,255,255,.05));padding:10px 18px;border-radius:25px;display:flex;align-items:center;gap:10px;font-size:.9rem;box-shadow:0 3px 10px rgba(0,0,0,.1);animation:tagPop .3s}
        @keyframes tagPop{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}
        .ptag .dot{width:18px;height:18px;border-radius:50%;border:2px solid #fff}
        .remove-p{background:var(--danger);border:none;color:#fff;width:22px;height:22px;border-radius:50%;cursor:pointer;font-size:.8rem;transition:all .2s}
        .remove-p:hover{transform:scale(1.2)}
        .modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:2000;padding:20px;overflow-y:auto;backdrop-filter:blur(5px)}
        .modal-overlay.active{display:flex}
        .modal{background:var(--card);border-radius:25px;width:100%;max-width:850px;max-height:90vh;overflow-y:auto;animation:modalPop .3s}
        @keyframes modalPop{0%{transform:scale(.9) translateY(20px);opacity:0}100%{transform:scale(1) translateY(0);opacity:1}}
        .modal-head{background:linear-gradient(135deg,var(--purple),#a29bfe);padding:20px 25px;border-radius:25px 25px 0 0;display:flex;justify-content:space-between;align-items:center}
        .modal-title{font-family:'Righteous',cursive;font-size:1.4rem;color:#fff}
        .close-modal{background:rgba(255,255,255,.2);border:none;color:#fff;width:40px;height:40px;border-radius:50%;font-size:1.3rem;cursor:pointer;transition:all .3s}
        .close-modal:hover{background:rgba(255,255,255,.3);transform:rotate(90deg)}
        .modal-body{padding:25px}
        .admin-tabs{display:flex;gap:10px;margin-bottom:25px;flex-wrap:wrap}
        .admin-tab{padding:10px 20px;background:rgba(255,255,255,.1);border:none;border-radius:12px;color:var(--text);font-size:.9rem;font-weight:600;cursor:pointer;transition:all .3s}
        .admin-tab:hover{background:rgba(255,255,255,.2)}
        .admin-tab.active{background:var(--purple);color:#fff}
        .admin-content{display:none;animation:fadeIn .3s}
        .admin-content.active{display:block}
        @keyframes fadeIn{0%{opacity:0}100%{opacity:1}}
        .qlist{max-height:350px;overflow-y:auto;border:2px solid var(--border);border-radius:16px;margin-bottom:20px}
        .qitem{padding:15px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;font-size:.9rem;transition:all .2s}
        .qitem:hover{background:rgba(255,255,255,.05)}
        .qemoji{font-size:1.8rem}
        .qtext{flex:1}
        .qtext h4{font-size:.9rem;margin-bottom:3px}
        .qtext p{font-size:.75rem;opacity:.6}
        .qcountry{padding:4px 12px;border-radius:20px;font-size:.75rem;color:#fff}
        .qactions{display:flex;gap:8px}
        .qactions button{padding:8px 12px;border:none;border-radius:8px;cursor:pointer;font-size:.8rem;transition:all .2s}
        .qactions button:hover{transform:scale(1.1)}
        .btn-edit{background:var(--warning);color:#fff}
        .btn-del{background:var(--danger);color:#fff}
        .add-form{background:rgba(255,255,255,.05);border-radius:16px;padding:20px;border:2px solid var(--border)}
        .form-title{font-family:'Righteous',cursive;font-size:1.1rem;margin-bottom:18px;color:var(--accent)}
        .fgroup{margin-bottom:15px}
        .fgroup label{display:block;font-size:.85rem;margin-bottom:6px;opacity:.8;font-weight:600}
        .fgroup input,.fgroup textarea,.fgroup select{width:100%;padding:12px 15px;border:2px solid var(--border);border-radius:10px;background:rgba(0,0,0,.2);color:var(--text);font-size:.95rem;transition:all .3s}
        .fgroup input:focus,.fgroup textarea:focus,.fgroup select:focus{outline:none;border-color:var(--purple)}
        .fgroup textarea{min-height:70px;resize:vertical}
        .frow{display:grid;grid-template-columns:1fr 1fr;gap:15px}
        .faction{display:flex;gap:12px;margin-top:20px}
        .fbtn{padding:12px 24px;border:none;border-radius:10px;cursor:pointer;font-size:.9rem;font-weight:600;transition:all .3s}
        .fbtn:hover{transform:scale(1.05)}
        .fbtn.primary{background:var(--purple);color:#fff}
        .fbtn.secondary{background:var(--border);color:var(--text)}
        .country-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}
        .country-card{padding:20px;border-radius:16px;text-align:center;transition:all .3s}
        .country-card:hover{transform:scale(1.05)}
        .country-card.turkey{background:linear-gradient(135deg,#ffebee,#ffcdd2);color:#c62828}
        .country-card.usa{background:linear-gradient(135deg,#e3f2fd,#bbdefb);color:#1565c0}
        .country-card.japan{background:linear-gradient(135deg,#fce4ec,#f8bbd0);color:#ad1457}
        .country-card.palestine{background:linear-gradient(135deg,#e8f5e9,#c8e6c9);color:#2e7d32}
        .country-card .flag{font-size:3rem;margin-bottom:8px}
        .country-card h4{font-family:'Righteous',cursive;margin-bottom:5px}
        .country-card p{font-size:.8rem;opacity:.8}
        .coin-anim{position:fixed;font-size:2rem;z-index:3000;pointer-events:none;animation:coinFly 1s forwards}
        @keyframes coinFly{0%{transform:scale(0) rotate(0);opacity:0}30%{transform:scale(1.5) rotate(180deg);opacity:1}100%{transform:translateY(-120px) rotate(360deg) scale(.5);opacity:0}}
        .winner-trophy{animation:winBounce 1s ease infinite}
        @keyframes winBounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}
        @media(max-width:1100px){.main{flex-direction:column}.left,.right{width:100%;flex-direction:row;flex-wrap:wrap;justify-content:center}.left .box,.right .mini-deck{flex:1;min-width:150px;max-width:250px}.board-content{flex-direction:column;align-items:center}.game-board{width:100%;max-width:400px}.card-area{width:100%}}
        @media(max-width:500px){.game-board{min-width:280px;width:100%}.frow{grid-template-columns:1fr}}
    </style>
</head>
<body class="dark">
    <div class="confetti-box" id="confetti"></div>
    <div class="header">
        <div class="logo">ğŸŒ Duygular AtlasÄ±</div>
        <div class="header-btns">
            <button class="hbtn btn-admin" onclick="openAdmin()">âš™ï¸ Admin</button>
            <button class="hbtn btn-theme" onclick="toggleTheme()" id="themeBtn">â˜€ï¸ GÃ¼ndÃ¼z</button>
            <button class="hbtn btn-sound" onclick="toggleSound()" id="soundBtn">ğŸ”Š</button>
        </div>
    </div>
    <div class="main" id="app"></div>
    <div class="modal-overlay" id="adminModal">
        <div class="modal">
            <div class="modal-head">
                <span class="modal-title">âš™ï¸ Admin Paneli</span>
                <button class="close-modal" onclick="closeAdmin()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchTab('emotions')">ğŸ’­ Duygular</button>
                    <button class="admin-tab" onclick="switchTab('penalties')">âš ï¸ Cezalar</button>
                    <button class="admin-tab" onclick="switchTab('settings')">ğŸ® Ayarlar</button>
                </div>
                <div class="admin-content active" id="emotionsTab"></div>
                <div class="admin-content" id="penaltiesTab"></div>
                <div class="admin-content" id="settingsTab"></div>
            </div>
        </div>
    </div>
    <div class="modal-overlay" id="countryModal">
        <div class="modal" style="max-width:600px">
            <div class="modal-head" style="background:linear-gradient(135deg,var(--secondary),#74b9ff)">
                <span class="modal-title">ğŸŒ Ãœlke KÃ¼ltÃ¼rleri</span>
                <button class="close-modal" onclick="closeCountry()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="country-grid">
                    <div class="country-card turkey"><div class="flag">ğŸ‡¹ğŸ‡·</div><h4>TÃ¼rkiye</h4><p>Misafirperverlik â€¢ SÄ±caklÄ±k<br>Aile baÄŸlarÄ± â€¢ CÃ¶mertlik</p></div>
                    <div class="country-card usa"><div class="flag">ğŸ‡ºğŸ‡¸</div><h4>ABD</h4><p>Bireysellik â€¢ Ã–zgÃ¼ven<br>DoÄŸrudan iletiÅŸim â€¢ Pozitiflik</p></div>
                    <div class="country-card japan"><div class="flag">ğŸ‡¯ğŸ‡µ</div><h4>Japonya</h4><p>SaygÄ± â€¢ AlÃ§akgÃ¶nÃ¼llÃ¼lÃ¼k<br>Grup uyumu â€¢ Nezaket</p></div>
                    <div class="country-card palestine"><div class="flag">ğŸ‡µğŸ‡¸</div><h4>Filistin</h4><p>DayanÄ±ÅŸma â€¢ Misafirperverlik<br>Aile sevgisi â€¢ Umut</p></div>
                </div>
            </div>
        </div>
    </div>
<script>
let isDark=true,soundOn=true;
const AC=window.AudioContext||window.webkitAudioContext;
let actx=null;
function toggleTheme(){isDark=!isDark;document.body.className=isDark?'dark':'light';document.getElementById('themeBtn').innerHTML=isDark?'â˜€ï¸ GÃ¼ndÃ¼z':'ğŸŒ™ Gece';playSound('click')}
function toggleSound(){soundOn=!soundOn;document.getElementById('soundBtn').textContent=soundOn?'ğŸ”Š':'ğŸ”‡'}
function playSound(t){if(!soundOn)return;if(!actx)actx=new AC();const o=actx.createOscillator(),g=actx.createGain();o.connect(g);g.connect(actx.destination);const n=actx.currentTime;switch(t){case'click':o.frequency.setValueAtTime(800,n);o.frequency.exponentialRampToValueAtTime(600,n+.1);g.gain.setValueAtTime(.1,n);g.gain.exponentialRampToValueAtTime(.01,n+.1);o.start(n);o.stop(n+.1);break;case'dice':o.type='square';o.frequency.setValueAtTime(200,n);o.frequency.linearRampToValueAtTime(800,n+.1);o.frequency.linearRampToValueAtTime(400,n+.2);g.gain.setValueAtTime(.15,n);g.gain.exponentialRampToValueAtTime(.01,n+.25);o.start(n);o.stop(n+.25);break;case'move':o.frequency.setValueAtTime(500,n);o.frequency.exponentialRampToValueAtTime(700,n+.08);g.gain.setValueAtTime(.12,n);g.gain.exponentialRampToValueAtTime(.01,n+.1);o.start(n);o.stop(n+.1);break;case'correct':o.frequency.setValueAtTime(523,n);o.frequency.setValueAtTime(659,n+.12);o.frequency.setValueAtTime(784,n+.24);o.frequency.setValueAtTime(1047,n+.36);g.gain.setValueAtTime(.2,n);g.gain.exponentialRampToValueAtTime(.01,n+.5);o.start(n);o.stop(n+.5);break;case'wrong':o.type='sawtooth';o.frequency.setValueAtTime(300,n);o.frequency.exponentialRampToValueAtTime(100,n+.3);g.gain.setValueAtTime(.15,n);g.gain.exponentialRampToValueAtTime(.01,n+.3);o.start(n);o.stop(n+.3);break;case'coin':o.frequency.setValueAtTime(1200,n);o.frequency.exponentialRampToValueAtTime(1800,n+.1);o.frequency.exponentialRampToValueAtTime(1400,n+.2);g.gain.setValueAtTime(.15,n);g.gain.exponentialRampToValueAtTime(.01,n+.25);o.start(n);o.stop(n+.25);break;case'win':[523,659,784,1047,1319].forEach((f,i)=>{const os=actx.createOscillator(),ga=actx.createGain();os.connect(ga);ga.connect(actx.destination);os.frequency.setValueAtTime(f,n+i*.15);ga.gain.setValueAtTime(.2,n+i*.15);ga.gain.exponentialRampToValueAtTime(.01,n+i*.15+.2);os.start(n+i*.15);os.stop(n+i*.15+.2)});return;case'bonus':o.frequency.setValueAtTime(800,n);o.frequency.setValueAtTime(1000,n+.1);o.frequency.setValueAtTime(1200,n+.2);g.gain.setValueAtTime(.15,n);g.gain.exponentialRampToValueAtTime(.01,n+.35);o.start(n);o.stop(n+.35);break}}
function fireConfetti(){const c=document.getElementById('confetti'),cols=['#FF6B6B','#4ECDC4','#FFE66D','#9B59B6','#2ECC71','#3498DB','#E74C3C','#F39C12'];for(let i=0;i<100;i++){setTimeout(()=>{const e=document.createElement('div');e.className='confetti';e.style.left=Math.random()*100+'%';e.style.background=cols[Math.floor(Math.random()*cols.length)];e.style.animationDuration=(2+Math.random()*2)+'s';if(Math.random()>.5)e.style.borderRadius='50%';c.appendChild(e);setTimeout(()=>e.remove(),4000)},i*30)}}
function miniConfetti(){const c=document.getElementById('confetti'),cols=['#FFE66D','#2ECC71','#4ECDC4'];for(let i=0;i<30;i++){setTimeout(()=>{const e=document.createElement('div');e.className='confetti';e.style.left=(40+Math.random()*20)+'%';e.style.background=cols[Math.floor(Math.random()*cols.length)];e.style.animationDuration=(1.5+Math.random())+'s';c.appendChild(e);setTimeout(()=>e.remove(),2500)},i*20)}}
const countries=[{id:'turkey',flag:'ğŸ‡¹ğŸ‡·',name:'TÃ¼rkiye',color:'#E30A17'},{id:'usa',flag:'ğŸ‡ºğŸ‡¸',name:'ABD',color:'#3C3B6E'},{id:'japan',flag:'ğŸ‡¯ğŸ‡µ',name:'Japonya',color:'#BC002D'},{id:'palestine',flag:'ğŸ‡µğŸ‡¸',name:'Filistin',color:'#007A3D'}];
const playerColors=['#FF6B6B','#4ECDC4','#FFE66D','#9B59B6','#3498DB','#E67E22'];
let emotions=[{scenario:"Eve misafir geldi, Ã§ay ikram edildi. Misafir kibarca reddetti ama ev sahibi Ä±srar etti.",emoji:"â˜•",country:"turkey",note:"TÃ¼rk kÃ¼ltÃ¼rÃ¼nde ikramÄ± reddetmek ayÄ±p sayÄ±lÄ±r."},{scenario:"ToplantÄ±da biri kartvizitini tek eliyle uzattÄ±.",emoji:"ğŸ’³",country:"japan",note:"Japonya'da kartvizit iki elle alÄ±nÄ±p verilir."},{scenario:"Restoranda hesap geldi, herkes kendi payÄ±nÄ± Ã¶dedi.",emoji:"ğŸ’µ",country:"usa",note:"ABD'de ayrÄ± Ã¶deme normaldir."},{scenario:"Aile yemeÄŸinde bÃ¼yÃ¼kler oturmadan kimse baÅŸlamadÄ±.",emoji:"ğŸ‘´",country:"palestine",note:"Filistin'de bÃ¼yÃ¼klere saygÄ± Ã§ok Ã¶nemlidir."},{scenario:"Ä°ÅŸ gÃ¶rÃ¼ÅŸmesinde sÄ±kÄ± el sÄ±kÄ±ÅŸma ve gÃ¶z temasÄ±.",emoji:"ğŸ¤",country:"usa",note:"ABD'de gÃ¼Ã§lÃ¼ el sÄ±kÄ±ÅŸma Ã¶zgÃ¼ven gÃ¶sterir."},{scenario:"TanÄ±ÅŸÄ±rken karÅŸÄ±nÄ±zdaki hafifÃ§e eÄŸildi.",emoji:"ğŸ™‡",country:"japan",note:"Japonya'da eÄŸilmek saygÄ± gÃ¶stergesidir."},{scenario:"Uzun sÃ¼redir gÃ¶rmediÄŸiniz biri sarÄ±lÄ±p yanaÄŸÄ±nÄ±zdan Ã¶ptÃ¼.",emoji:"ğŸ¤—",country:"turkey",note:"TÃ¼rk kÃ¼ltÃ¼rÃ¼nde sarÄ±lmak normaldir."},{scenario:"Aile toplantÄ±sÄ±nda herkes kucaklaÅŸarak karÅŸÄ±laÅŸtÄ±.",emoji:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦",country:"palestine",note:"Filistin'de aile baÄŸlarÄ± gÃ¼Ã§lÃ¼dÃ¼r."},{scenario:"Hediye verirken iki elle tutup reverans yaptÄ±nÄ±z.",emoji:"ğŸ",country:"japan",note:"Japonya'da hediye verme ritÃ¼eldir."},{scenario:"Eve giderken tatlÄ± gÃ¶tÃ¼rdÃ¼nÃ¼z, bol ikram aldÄ±nÄ±z.",emoji:"ğŸ°",country:"turkey",note:"TÃ¼rk kÃ¼ltÃ¼rÃ¼nde eli boÅŸ gidilmez."},{scenario:"DoÄŸum gÃ¼nÃ¼nÃ¼zde herkes bireysel hediye getirdi.",emoji:"ğŸ‚",country:"usa",note:"ABD'de bireysel kutlamalar Ã¶nemlidir."},{scenario:"KomÅŸunuz evde yaptÄ±ÄŸÄ± yemekten bir tabak getirdi.",emoji:"ğŸ²",country:"palestine",note:"Filistin'de komÅŸuluk gÃ¼Ã§lÃ¼dÃ¼r."},{scenario:"BaÅŸarÄ±sÄ±zlÄ±k sonrasÄ± 'Sorun yok' deyip gÃ¼lÃ¼msedi.",emoji:"ğŸ˜Š",country:"japan",note:"Japonya'da negatif duygu gÃ¶stermemek erdemdir."},{scenario:"ÃœzÃ¼cÃ¼ haber sonrasÄ± aÃ§Ä±kÃ§a aÄŸladÄ±.",emoji:"ğŸ˜¢",country:"turkey",note:"TÃ¼rk kÃ¼ltÃ¼rÃ¼nde duygular aÃ§Ä±kÃ§a ifade edilir."},{scenario:"BaÅŸarÄ± sonrasÄ± 'Ben baÅŸardÄ±m!' diye kutladÄ±.",emoji:"ğŸ‰",country:"usa",note:"ABD'de bireysel baÅŸarÄ± kutlanÄ±r."},{scenario:"Zor zamanlarda tÃ¼m aile destek iÃ§in toplandÄ±.",emoji:"ğŸ’ª",country:"palestine",note:"Filistin'de dayanÄ±ÅŸma gÃ¼Ã§lÃ¼dÃ¼r."},{scenario:"Patron konuÅŸurken herkes sessizce dinledi.",emoji:"ğŸ¤«",country:"japan",note:"Japonya'da hiyerarÅŸi Ã¶nemlidir."},{scenario:"Yemekte tabak bitti, ev sahibi hemen doldurdu.",emoji:"ğŸ½ï¸",country:"turkey",note:"TÃ¼rk kÃ¼ltÃ¼rÃ¼nde tabak boÅŸ kalmamalÄ±."},{scenario:"Garsonunuza %20 bahÅŸiÅŸ bÄ±raktÄ±nÄ±z.",emoji:"ğŸ’°",country:"usa",note:"ABD'de bahÅŸiÅŸ zorunludur."},{scenario:"BÃ¼yÃ¼k tabaktan herkes birlikte yemek yedi.",emoji:"ğŸ«“",country:"palestine",note:"Ortak tabak birliÄŸi simgeler."}];
let penalties=[{text:"ğŸ” Tavuk gibi 30 saniye gÄ±dakla!",coins:-2,jail:false},{text:"ğŸ•º 30 saniye dans et!",coins:-1,jail:false},{text:"ğŸ¦ Aslan gibi kÃ¼kre!",coins:0,jail:false},{text:"ğŸ­ Robot gibi hareket et!",coins:-1,jail:false},{text:"ğŸ  KODESE GÄ°R!",coins:0,jail:true},{text:"ğŸ’ƒ Bir Ã¼lkenin dansÄ±nÄ± taklit et!",coins:-1,jail:false},{text:"ğŸ—ºï¸ 5 Ã¼lke baÅŸkenti say!",coins:-2,jail:false},{text:"âœˆï¸ UÃ§ak gibi odayÄ± dolaÅŸ!",coins:-1,jail:false},{text:"ğŸ’ Maymun taklidi yap!",coins:-1,jail:false},{text:"ğŸ  KODESE GÄ°R!",coins:0,jail:true},{text:"ğŸ¤ Bir ÅŸarkÄ± mÄ±rÄ±ldan!",coins:-1,jail:false},{text:"ğŸ¤ª Komik yÃ¼z yap!",coins:0,jail:false}];
let settings={startCoins:10,jailCost:5,jailTurns:2,wrongMult:2};
let players=[],curPlayer=0,phase='roll',curQ=null,usedQ=[],gameOn=false;
const BSIZE=32,cellTypes=[];
for(let i=0;i<BSIZE;i++){if(i===0)cellTypes.push('start');else if(i===BSIZE-1)cellTypes.push('finish');else if(i===16)cellTypes.push('jail');else if(i===8||i===24)cellTypes.push('bonus');else if(i%4===0)cellTypes.push('emotion');else if(i%7===0)cellTypes.push('penalty');else cellTypes.push('flag')}
function render(){document.getElementById('app').innerHTML=gameOn?renderGame():renderStart()}
function renderStart(){return`<div class="left"></div><div class="center"><div class="board-wrap"><div class="start-screen"><h2>ğŸŒ Duygular AtlasÄ±</h2><p style="opacity:.7;margin-bottom:20px">2-6 oyuncu ekleyin ve baÅŸlayÄ±n!</p><div class="pinput"><input type="text" id="nameInput" placeholder="Oyuncu adÄ±..." maxlength="12"><button class="act-btn btn-suc" onclick="addPlayer()">â•</button></div><div class="color-sel" id="colors">${playerColors.map((c,i)=>`<div class="color-opt" style="background:${c}" onclick="selectColor(${i})" data-i="${i}"></div>`).join('')}</div><div class="plist" id="plist"></div><button class="act-btn btn-suc" id="startBtn" style="display:none;margin-top:20px;padding:15px 40px;font-size:1.1rem" onclick="startGame()">ğŸš€ Oyunu BaÅŸlat</button></div></div></div><div class="right"><div class="box"><div class="box-title">ğŸ“œ NasÄ±l OynanÄ±r?</div><ul style="font-size:.8rem;opacity:.85;padding-left:18px;line-height:1.8"><li>ğŸ² Zar at ve ilerle</li><li>ğŸŒ Bayrak sorusu Ã§Ã¶z</li><li>ğŸ’­ Duygu senaryosu bil</li><li>âœ… DoÄŸru = Pul kazan</li><li>âŒ YanlÄ±ÅŸ = Ceza Ã§ek</li><li>ğŸ Bonus kazan</li><li>ğŸ† Hedefe ulaÅŸ!</li></ul></div></div>`}
let selColor=0;
function selectColor(i){if(players.find(p=>p.ci===i))return;selColor=i;document.querySelectorAll('.color-opt').forEach((e,x)=>{e.classList.toggle('selected',x===i);e.classList.toggle('used',players.some(p=>p.ci===x))});playSound('click')}
function addPlayer(){const inp=document.getElementById('nameInput'),name=inp.value.trim();if(!name){inp.focus();return}if(players.length>=6){alert('En fazla 6 oyuncu!');return}if(players.find(p=>p.name.toLowerCase()===name.toLowerCase())){alert('Bu isim var!');return}if(players.find(p=>p.ci===selColor)){alert('Bu renk kullanÄ±lÄ±yor!');return}playSound('coin');players.push({name,color:playerColors[selColor],ci:selColor,pos:0,coins:settings.startCoins,inJail:false,jailTurns:0});inp.value='';inp.focus();document.getElementById('plist').innerHTML=players.map((p,i)=>`<div class="ptag"><div class="dot" style="background:${p.color}"></div><span>${p.name}</span><button class="remove-p" onclick="removePlayer(${i})">Ã—</button></div>`).join('');document.querySelectorAll('.color-opt').forEach((e,x)=>e.classList.toggle('used',players.some(p=>p.ci===x)));for(let j=0;j<playerColors.length;j++){if(!players.find(p=>p.ci===j)){selectColor(j);break}}document.getElementById('startBtn').style.display=players.length>=2?'inline-flex':'none'}
function removePlayer(i){players.splice(i,1);render();setTimeout(()=>{document.getElementById('nameInput')?.focus();selectColor(0)},100)}
function startGame(){if(players.length<2)return;gameOn=true;playSound('win');fireConfetti();render()}
function renderGame(){const p=players[curPlayer];return`<div class="left"><div class="box"><div class="box-title">ğŸ‘¥ Oyuncular</div>${players.map((pl,i)=>`<div class="pcard ${i===curPlayer?'active':''} ${pl.inJail?'jail':''}"><div class="pion" style="background:${pl.color}">${i+1}</div><div class="pinfo"><div class="pname">${pl.name} ${pl.inJail?'ğŸ”’':''}</div><div class="pcoins">ğŸª™ ${pl.coins} Â· ğŸ“ ${pl.pos}/${BSIZE-1}</div></div></div>`).join('')}</div></div><div class="center"><div class="board-wrap"><div class="board-head"><span class="board-title">ğŸ® Oyun TahtasÄ±</span><span class="turn-info">ğŸ¯ ${p.name}</span></div><div class="board-content"><div class="game-board" id="board">${renderBoard()}</div><div class="card-area" id="cardArea">${renderCardArea()}</div></div><div class="dice-area"><button class="dice-btn" id="diceBtn" onclick="rollDice()" ${phase!=='roll'||p.inJail?'disabled':''}>ğŸ² Zar At</button><div class="dice-result" id="diceRes">?</div></div></div></div><div class="right"><div class="mini-deck" onclick="openCountry()"><div class="mini-deck-icon">ğŸŒ</div><div class="mini-deck-title">Ãœlke Bilgisi</div></div><div class="box"><div class="box-title">ğŸ—ºï¸ Kareler</div><div style="font-size:.75rem;line-height:1.9">ğŸš€ BaÅŸla | ğŸ† BitiÅŸ<br>ğŸŒ Bayrak | ğŸ’­ Duygu<br>âš ï¸ Ceza | ğŸ Bonus<br>ğŸ  Kodese</div></div></div>`}
function renderBoard(){let h='';for(let r=0;r<9;r++){for(let c=0;c<9;c++){const idx=getCellIdx(r,c);if(idx===-1){h+='<div class="cell empty"></div>'}else{const t=cellTypes[idx],icons={start:'ğŸš€',finish:'ğŸ†',jail:'ğŸ ',bonus:'ğŸ',flag:'ğŸŒ',emotion:'ğŸ’­',penalty:'âš ï¸'};h+=`<div class="cell ${t}" data-idx="${idx}"><span class="cell-num">${idx}</span><span class="cell-icon">${icons[t]}</span><div class="pion-box" id="c${idx}"></div></div>`}}}return h}
function getCellIdx(r,c){if(r===0)return c;if(c===8&&r>0&&r<8)return 8+r;if(r===8)return 24-c;if(c===0&&r>0&&r<8)return 32-r;return -1}
function renderPions(){document.querySelectorAll('.pion-box').forEach(e=>e.innerHTML='');players.forEach((p,i)=>{const cell=document.getElementById('c'+p.pos);if(cell)cell.innerHTML+=`<div class="pion" style="background:${p.color}">${i+1}</div>`})}
function renderCardArea(){const p=players[curPlayer];if(p.inJail)return`<div class="card-display"><div class="gcard penalty"><div class="card-icon">ğŸ”’</div><div class="card-title">Kodestesin!</div><div class="card-text">${p.jailTurns} tur bekle veya ${settings.jailCost} pul ver</div></div><div class="act-btns" style="margin-top:20px"><button class="act-btn btn-war" onclick="waitJail()">â³ Bekle</button>${p.coins>=settings.jailCost?`<button class="act-btn btn-suc" onclick="payJail()">ğŸª™ ${settings.jailCost} Pul</button>`:''}</div></div>`;return`<div class="card-display"><div class="msg-box"><h3>ğŸ² Zar At!</h3><p>${p.name}, sÄ±ra sende!</p></div></div>`}
function rollDice(){const p=players[curPlayer];if(phase!=='roll'||p.inJail)return;playSound('dice');const dE=document.getElementById('diceRes'),dB=document.getElementById('diceBtn');dB.disabled=true;dE.classList.add('dice-anim');let cnt=0;const iv=setInterval(()=>{dE.textContent=Math.floor(Math.random()*6)+1;cnt++;if(cnt>12){clearInterval(iv);dE.classList.remove('dice-anim');const res=Math.floor(Math.random()*6)+1;dE.textContent=res;movePlayer(res)}},70)}
function movePlayer(steps){const p=players[curPlayer],target=Math.min(p.pos+steps,BSIZE-1);const mv=setInterval(()=>{if(p.pos<target){p.pos++;playSound('move');renderPions()}else{clearInterval(mv);if(p.pos>=BSIZE-1){endGame(p);return}handleCell()}},200)}
function handleCell(){const p=players[curPlayer],t=cellTypes[p.pos];switch(t){case'flag':showFlagQ();break;case'emotion':showEmotionQ();break;case'penalty':showPenalty(1);break;case'bonus':showBonus();break;case'jail':p.inJail=true;p.jailTurns=settings.jailTurns;playSound('wrong');render();renderPions();break;default:nextTurn()}}
function showFlagQ(){phase='question';const co=countries[Math.floor(Math.random()*countries.length)];curQ={type:'flag',ans:co.id};const opts=[...countries].sort(()=>Math.random()-.5);document.getElementById('cardArea').innerHTML=`<div class="card-display"><div class="gcard flag"><div class="card-type">Bayrak Sorusu</div><div class="card-icon">${co.flag}</div><div class="card-title">Bu hangi Ã¼lke?</div></div><div class="opts">${opts.map(c=>`<button class="opt-btn" onclick="checkAns('${c.id}')"><span class="opt-flag">${c.flag}</span> ${c.name}</button>`).join('')}</div></div>`}
function showEmotionQ(){phase='question';let av=emotions.filter((_,i)=>!usedQ.includes(i));if(!av.length){usedQ=[];av=emotions}const idx=Math.floor(Math.random()*av.length),q=av[idx];usedQ.push(emotions.indexOf(q));curQ={type:'emotion',ans:q.country,note:q.note};const opts=[...countries].sort(()=>Math.random()-.5);document.getElementById('cardArea').innerHTML=`<div class="card-display"><div class="gcard emotion"><div class="card-type">Duygu Senaryosu</div><div class="card-icon">${q.emoji}</div><div class="card-text">${q.scenario}</div></div><div class="opts"><p style="text-align:center;font-size:.85rem;margin-bottom:10px;opacity:.9">Hangi kÃ¼ltÃ¼re ait?</p>${opts.map(c=>`<button class="opt-btn" onclick="checkAns('${c.id}')"><span class="opt-flag">${c.flag}</span> ${c.name}</button>`).join('')}</div></div>`}
function checkAns(a){const btns=document.querySelectorAll('.opt-btn');btns.forEach(b=>b.disabled=true);const ok=a===curQ.ans,cc=countries.find(c=>c.id===curQ.ans);ok?playSound('correct'):playSound('wrong');if(ok)miniConfetti();btns.forEach(b=>{if(b.textContent.includes(cc.name))b.classList.add('correct');const sc=countries.find(c=>c.id===a);if(sc&&b.textContent.includes(sc.name)&&!ok)b.classList.add('wrong')});setTimeout(()=>ok?showReward():showWrong(cc),1000)}
function showReward(){const p=players[curPlayer],coins=Math.floor(Math.random()*3)+1;p.coins+=coins;playSound('coin');showCoinAnim(coins);document.getElementById('cardArea').innerHTML=`<div class="card-display"><div class="gcard reward"><div class="card-icon">ğŸ‰</div><div class="card-title">DoÄŸru!</div><div class="card-text" style="font-size:2rem;margin-top:10px">+${coins} ğŸª™</div></div>${curQ.note?`<div class="cult-note"><strong>ğŸ’¡</strong> ${curQ.note}</div>`:''}<div class="act-btns"><button class="act-btn btn-suc" onclick="nextTurn()">â¡ï¸ Devam</button></div></div>`;updatePlayers()}
function showWrong(cc){document.getElementById('cardArea').innerHTML=`<div class="card-display"><div class="msg-box error"><h3>ğŸ˜” YanlÄ±ÅŸ!</h3><p>DoÄŸru: ${cc.flag} ${cc.name}</p></div>${curQ.note?`<div class="cult-note"><strong>ğŸ’¡</strong> ${curQ.note}</div>`:''}<p style="margin-top:15px;font-size:.9rem">Ne yapmak istersin?</p><div class="act-btns" style="flex-direction:column;gap:12px;margin-top:15px"><button class="act-btn btn-dan" onclick="showPenalty(1)">âš ï¸ Ceza KartÄ±</button><button class="act-btn btn-pur" onclick="showEmotionQ()">ğŸ’­ Duygu ile Kurtar</button></div><p style="font-size:.8rem;opacity:.7;margin-top:12px">âš ï¸ Duygu yanlÄ±ÅŸsa ceza ${settings.wrongMult}x!</p></div>`}
function showPenalty(m){phase='penalty';const pen=penalties[Math.floor(Math.random()*penalties.length)];playSound('wrong');const ct=pen.coins?`<p style="margin-top:12px;font-size:1.1rem">ğŸ’° ${pen.coins*m} pul</p>`:'';document.getElementById('cardArea').innerHTML=`<div class="card-display"><div class="gcard penalty"><div class="card-type">Ceza ${m>1?`(${m}x!)`:''}</div><div class="card-icon">${pen.jail?'ğŸ ':'âš ï¸'}</div><div class="card-title">${pen.jail?'KODESE!':'CEZA!'}</div><div class="card-text">${pen.text}${ct}</div></div><div class="act-btns"><button class="act-btn btn-war" onclick="execPen('${pen.text.replace(/'/g,"\\'")}',${pen.coins},${pen.jail},${m})">âœ… Kabul</button></div></div>`}
function execPen(txt,coins,jail,m){const p=players[curPlayer];if(coins){const t=coins*m;p.coins+=t;if(p.coins<0)p.coins=0;showCoinAnim(t)}if(jail){p.inJail=true;p.jailTurns=settings.jailTurns;p.pos=16;renderPions()}playSound('coin');nextTurn()}
function showBonus(){const p=players[curPlayer],coins=2+Math.floor(Math.random()*2);p.coins+=coins;playSound('bonus');miniConfetti();showCoinAnim(coins);document.getElementById('cardArea').innerHTML=`<div class="card-display"><div class="gcard bonus"><div class="card-type">Bonus!</div><div class="card-icon">ğŸ</div><div class="card-title">Tebrikler!</div><div class="card-text" style="font-size:1.8rem">+${coins} ğŸª™</div></div><div class="act-btns"><button class="act-btn btn-suc" onclick="nextTurn()">â¡ï¸ Devam</button></div></div>`;updatePlayers()}
function waitJail(){const p=players[curPlayer];p.jailTurns--;if(p.jailTurns<=0){p.inJail=false;playSound('correct');miniConfetti()}else{playSound('click')}nextTurn()}
function payJail(){const p=players[curPlayer];p.coins-=settings.jailCost;p.inJail=false;p.jailTurns=0;showCoinAnim(-settings.jailCost);playSound('coin');phase='roll';render();renderPions()}
function updatePlayers(){const box=document.querySelector('.left .box');if(box)box.innerHTML=`<div class="box-title">ğŸ‘¥ Oyuncular</div>${players.map((pl,i)=>`<div class="pcard ${i===curPlayer?'active':''} ${pl.inJail?'jail':''}"><div class="pion" style="background:${pl.color}">${i+1}</div><div class="pinfo"><div class="pname">${pl.name} ${pl.inJail?'ğŸ”’':''}</div><div class="pcoins">ğŸª™ ${pl.coins} Â· ğŸ“ ${pl.pos}/${BSIZE-1}</div></div></div>`).join('')}`}
function nextTurn(){curPlayer=(curPlayer+1)%players.length;phase='roll';curQ=null;playSound('click');render();renderPions()}
function endGame(winner){playSound('win');fireConfetti();const sorted=[...players].sort((a,b)=>b.coins-a.coins);document.getElementById('app').innerHTML=`<div class="center" style="max-width:550px;margin:30px auto"><div class="board-wrap" style="text-align:center;padding:40px"><div class="winner-trophy" style="font-size:5rem">ğŸ†</div><h2 style="font-family:'Righteous',cursive;color:var(--accent);font-size:2rem;margin:20px 0">${winner.name} KazandÄ±!</h2><p style="opacity:.8;margin-bottom:25px">Hedefe ilk ulaÅŸan!</p><div style="margin-bottom:30px">${sorted.map((p,i)=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:15px 25px;margin:10px 0;background:${i===0?'linear-gradient(135deg,var(--accent),#fdcb6e)':i===sorted.length-1?'linear-gradient(135deg,#636e72,#2d3436)':'rgba(255,255,255,.1)'};border-radius:15px;color:${i===0?'#333':'#fff'}"><span style="display:flex;align-items:center;gap:10px"><span style="font-size:1.5rem">${i===0?'ğŸ‘‘':i===1?'ğŸ¥ˆ':i===2?'ğŸ¥‰':'ğŸ®'}</span><span style="font-weight:600">${p.name}</span></span><span style="font-weight:700">ğŸª™ ${p.coins}</span></div>`).join('')}</div><button class="act-btn btn-suc" style="padding:18px 45px;font-size:1.1rem" onclick="resetGame()">ğŸ”„ Yeni Oyun</button></div></div>`}
function resetGame(){players=[];curPlayer=0;phase='roll';curQ=null;usedQ=[];gameOn=false;render()}
function showCoinAnim(a){const em=a>0?'ğŸª™':'ğŸ’¸',col=a>0?'#2ECC71':'#E74C3C';for(let i=0;i<Math.min(Math.abs(a),5);i++){setTimeout(()=>{const e=document.createElement('div');e.className='coin-anim';e.textContent=em;e.style.left=(40+Math.random()*20)+'%';e.style.top=(35+Math.random()*15)+'%';e.style.color=col;document.body.appendChild(e);setTimeout(()=>e.remove(),1000)},i*100)}}
function openAdmin(){document.getElementById('adminModal').classList.add('active');renderAdmin();playSound('click')}
function closeAdmin(){document.getElementById('adminModal').classList.remove('active');playSound('click')}
function openCountry(){document.getElementById('countryModal').classList.add('active');playSound('click')}
function closeCountry(){document.getElementById('countryModal').classList.remove('active');playSound('click')}
function switchTab(t){document.querySelectorAll('.admin-tab').forEach(e=>e.classList.remove('active'));document.querySelectorAll('.admin-content').forEach(e=>e.classList.remove('active'));event.target.classList.add('active');document.getElementById(t+'Tab').classList.add('active');playSound('click')}
function renderAdmin(){document.getElementById('emotionsTab').innerHTML=`<div class="qlist">${emotions.map((e,i)=>{const c=countries.find(x=>x.id===e.country);return`<div class="qitem"><span class="qemoji">${e.emoji}</span><div class="qtext"><h4>${e.scenario.substring(0,50)}${e.scenario.length>50?'...':''}</h4><p>${e.note.substring(0,40)}...</p></div><span class="qcountry" style="background:${c?.color||'#666'}">${c?.flag||'?'}</span><div class="qactions"><button class="btn-edit" onclick="editEmo(${i})">âœï¸</button><button class="btn-del" onclick="delEmo(${i})">ğŸ—‘ï¸</button></div></div>`}).join('')}</div><div class="add-form"><div class="form-title">â• Yeni Duygu Sorusu</div><div class="fgroup"><label>Senaryo</label><textarea id="newScen" placeholder="Ã–rn: Eve misafir geldi..."></textarea></div><div class="frow"><div class="fgroup"><label>Emoji</label><input id="newEmoji" placeholder="â˜•" maxlength="2"></div><div class="fgroup"><label>Ãœlke</label><select id="newCo">${countries.map(c=>`<option value="${c.id}">${c.flag} ${c.name}</option>`).join('')}</select></div></div><div class="fgroup"><label>KÃ¼ltÃ¼rel Not</label><textarea id="newNote" placeholder="AÃ§Ä±klama..."></textarea></div><div class="faction"><button class="fbtn primary" onclick="addEmo()">âœ… Ekle</button><button class="fbtn secondary" onclick="clearEmoForm()">ğŸ”„ Temizle</button></div></div>`;document.getElementById('penaltiesTab').innerHTML=`<div class="qlist">${penalties.map((p,i)=>`<div class="qitem"><span class="qemoji">${p.jail?'ğŸ ':'âš ï¸'}</span><div class="qtext"><h4>${p.text}</h4><p>Pul: ${p.coins} | Kodese: ${p.jail?'Evet':'HayÄ±r'}</p></div><div class="qactions"><button class="btn-edit" onclick="editPen(${i})">âœï¸</button><button class="btn-del" onclick="delPen(${i})">ğŸ—‘ï¸</button></div></div>`).join('')}</div><div class="add-form"><div class="form-title">â• Yeni Ceza</div><div class="fgroup"><label>Metin</label><textarea id="newPenTxt" placeholder="30 saniye dans et!"></textarea></div><div class="frow"><div class="fgroup"><label>Pul (0 veya -)</label><input type="number" id="newPenCoins" value="0" max="0"></div><div class="fgroup"><label>Kodese?</label><select id="newPenJail"><option value="false">HayÄ±r</option><option value="true">Evet</option></select></div></div><div class="faction"><button class="fbtn primary" onclick="addPen()">âœ… Ekle</button><button class="fbtn secondary" onclick="clearPenForm()">ğŸ”„ Temizle</button></div></div>`;document.getElementById('settingsTab').innerHTML=`<div class="add-form"><div class="form-title">ğŸ® Oyun AyarlarÄ±</div><div class="frow"><div class="fgroup"><label>BaÅŸlangÄ±Ã§ Pulu</label><input type="number" id="setCoins" value="${settings.startCoins}" min="1" max="50"></div><div class="fgroup"><label>Kodesten Ã‡Ä±kÄ±ÅŸ</label><input type="number" id="setJail" value="${settings.jailCost}" min="1" max="20"></div></div><div class="frow"><div class="fgroup"><label>Kodeste Bekleme</label><input type="number" id="setTurns" value="${settings.jailTurns}" min="1" max="5"></div><div class="fgroup"><label>YanlÄ±ÅŸ Ã‡arpanÄ±</label><input type="number" id="setMult" value="${settings.wrongMult}" min="1" max="5"></div></div><div class="faction"><button class="fbtn primary" onclick="saveSets()">ğŸ’¾ Kaydet</button><button class="fbtn secondary" onclick="resetSets()">ğŸ”„ VarsayÄ±lan</button></div><hr style="margin:20px 0;border-color:var(--border)"><div class="form-title">ğŸ“¦ Veri</div><div class="faction"><button class="fbtn primary" onclick="exportData()">ğŸ“¤ DÄ±ÅŸa Aktar</button><button class="fbtn secondary" onclick="importData()">ğŸ“¥ Ä°Ã§e Aktar</button></div></div>`}
function addEmo(){const s=document.getElementById('newScen').value.trim(),e=document.getElementById('newEmoji').value.trim(),c=document.getElementById('newCo').value,n=document.getElementById('newNote').value.trim();if(!s||!e||!n){alert('TÃ¼m alanlarÄ± doldurun!');return}emotions.push({scenario:s,emoji:e,country:c,note:n});saveData();renderAdmin();playSound('correct');alert('Eklendi!')}
function clearEmoForm(){document.getElementById('newScen').value='';document.getElementById('newEmoji').value='';document.getElementById('newNote').value=''}
function editEmo(i){const e=emotions[i];document.getElementById('newScen').value=e.scenario;document.getElementById('newEmoji').value=e.emoji;document.getElementById('newCo').value=e.country;document.getElementById('newNote').value=e.note;emotions.splice(i,1);saveData();renderAdmin()}
function delEmo(i){if(confirm('Silmek istediÄŸinize emin misiniz?')){emotions.splice(i,1);saveData();renderAdmin();playSound('click')}}
function addPen(){const t=document.getElementById('newPenTxt').value.trim(),c=parseInt(document.getElementById('newPenCoins').value)||0,j=document.getElementById('newPenJail').value==='true';if(!t){alert('Metin girin!');return}penalties.push({text:t,coins:c,jail:j});saveData();renderAdmin();playSound('correct');alert('Eklendi!')}
function clearPenForm(){document.getElementById('newPenTxt').value='';document.getElementById('newPenCoins').value='0';document.getElementById('newPenJail').value='false'}
function editPen(i){const p=penalties[i];document.getElementById('newPenTxt').value=p.text;document.getElementById('newPenCoins').value=p.coins;document.getElementById('newPenJail').value=p.jail.toString();penalties.splice(i,1);saveData();renderAdmin()}
function delPen(i){if(confirm('Silmek istediÄŸinize emin misiniz?')){penalties.splice(i,1);saveData();renderAdmin();playSound('click')}}
function saveSets(){settings.startCoins=parseInt(document.getElementById('setCoins').value)||10;settings.jailCost=parseInt(document.getElementById('setJail').value)||5;settings.jailTurns=parseInt(document.getElementById('setTurns').value)||2;settings.wrongMult=parseInt(document.getElementById('setMult').value)||2;saveData();playSound('correct');alert('Kaydedildi!')}
function resetSets(){settings={startCoins:10,jailCost:5,jailTurns:2,wrongMult:2};saveData();renderAdmin();playSound('click');alert('VarsayÄ±lana dÃ¶ndÃ¼rÃ¼ldÃ¼!')}
function saveData(){localStorage.setItem('da_emo',JSON.stringify(emotions));localStorage.setItem('da_pen',JSON.stringify(penalties));localStorage.setItem('da_set',JSON.stringify(settings))}
function loadData(){try{const e=localStorage.getItem('da_emo'),p=localStorage.getItem('da_pen'),s=localStorage.getItem('da_set');if(e)emotions=JSON.parse(e);if(p)penalties=JSON.parse(p);if(s)settings=JSON.parse(s)}catch(err){console.log('Veri yÃ¼klenemedi')}}
function exportData(){const d={emotions,penalties,settings,date:new Date().toISOString()};const b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='duygular-atlasi.json';a.click();playSound('correct')}
function importData(){const inp=document.createElement('input');inp.type='file';inp.accept='.json';inp.onchange=e=>{const r=new FileReader();r.onload=ev=>{try{const d=JSON.parse(ev.target.result);if(d.emotions)emotions=d.emotions;if(d.penalties)penalties=d.penalties;if(d.settings)settings={...settings,...d.settings};saveData();renderAdmin();playSound('correct');alert('Ä°Ã§e aktarÄ±ldÄ±!')}catch{alert('Dosya okunamadÄ±!')}};r.readAsText(e.target.files[0])};inp.click()}
loadData();render();
</script>
</body>
</html>
